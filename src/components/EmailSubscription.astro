---
import EnvelopeIcon from "@assets/icons/envelope.svg";

const FORMSPREE_URL = "https://formspree.io/f/myzpazje";
---

<section
  id="newsletter"
  class="py-20 bg-gradient-to-r from-[#f0fdfa] to-[#eff6ff]"
>
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <div
      id="newsletter-card"
      class="bg-white rounded-3xl shadow-xl p-8 md:p-12 transition-shadow duration-300 hover:shadow-2xl"
    >
      <!-- Mensaje de éxito
      <div id="success-message" class="hidden">
        <div class="text-green-500 text-6xl mb-4" aria-hidden="true">✓</div>
        <h3 class="text-2xl font-bold text-slate-800 mb-2">
          ¡Gracias por suscribirte!
        </h3>
        <p class="text-slate-600 text-lg">
          Pronto recibirás nuestro boletín con consejos y promociones
          exclusivas.
        </p>
      </div> -->

      <div id="form-container">
        <div
          class="mx-auto w-20 h-20 mb-6 flex items-center justify-center bg-teal-100 rounded-full text-teal-500"
          aria-hidden="true"
        >
          <EnvelopeIcon class="w-11 h-11" />
        </div>
        <h2 class="text-3xl md:text-4xl font-bold text-teal-700 mb-4">
          Mantente al Día con Consejos para tu Mascota
        </h2>
        <p class="text-lg text-slate-600 mb-8 max-w-2xl mx-auto">
          Elige cómo prefieres recibir nuestras promociones, consejos de cuidado
          y noticias de salud.
        </p>

        <form
          id="newsletter-form"
          class="max-w-md mx-auto"
          action={FORMSPREE_URL}
          method="POST"
        >
          <div
            class="bg-gray-200/70 p-1.5 rounded-full flex justify-center gap-2 mb-6 w-fit mx-auto"
          >
            <button
              type="button"
              id="btn-email"
              class="px-6 py-2 rounded-full font-semibold text-sm transition-all duration-300"
            >
              Correo Electrónico
            </button>
            <button
              type="button"
              id="btn-phone"
              class="px-6 py-2 rounded-full font-semibold text-sm transition-all duration-300"
            >
              WhatsApp
            </button>
          </div>
          <div class="relative flex flex-col sm:flex-row gap-3">
            <!-- 2. CAMPO OCULTO: Este campo le dirá a Formspree qué método eligió el usuario -->
            <input
              type="hidden"
              name="metodo_de_contacto"
              id="metodo-contacto"
              value="Correo Electrónico"
            />

            <input
              id="contact-input"
              name="contacto_del_usuario"
              type="email"
              placeholder="tu@correo.com"
              class="flex-1 w-full px-6 py-4 border border-slate-300 rounded-full focus:outline-none focus:ring-2 focus:ring-teal-400 focus:border-transparent text-md text-slate-700 transition"
              required
            />
            <button
              type="submit"
              class="bg-teal-600 hover:bg-teal-700 text-white px-8 py-4 rounded-full font-bold text-base transform hover:scale-105 transition-all duration-300 whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-600 sm:absolute sm:right-0 sm:inset-y-0 sm:h-full sm:py-0 sm:rounded-l-none"
            >
              Suscribirme
            </button>
          </div>
        </form>
      </div>

      <div class="mt-10 border-t border-gray-200 pt-6">
        <ul
          class="flex flex-col md:flex-row justify-center gap-x-10 gap-y-4 text-sm text-slate-500"
        >
          <li class="flex items-center justify-center gap-2">
            <span class="text-green-500">✓</span> Promociones exclusivas
          </li>
          <li class="flex items-center justify-center gap-2">
            <span class="text-green-500">✓</span> Consejos de cuidado
          </li>
          <li class="flex items-center justify-center gap-2">
            <span class="text-green-500">✓</span> Sin spam, prometido
          </li>
        </ul>
      </div>
    </div>
  </div>
</section>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    // Seleccionamos todos los elementos que necesitamos
    const btnEmail = document.getElementById("btn-email");
    const btnPhone = document.getElementById("btn-phone");
    const inputField = document.getElementById("contact-input");
    const hiddenMethodInput = document.getElementById("metodo-contacto");

    // Función para actualizar la UI del formulario según el método elegido
    function updateFormUI(method) {
      if (method === "email") {
        inputField.type = "email";
        inputField.placeholder = "Ingresa tu correo electrónico";
        hiddenMethodInput.value = "Correo Electrónico"; // Actualizamos el valor del campo oculto

        // Actualizamos los estilos de los botones
        btnEmail.classList.add("bg-white", "text-slate-800", "shadow-sm");
        btnEmail.classList.remove("text-slate-500");
        btnPhone.classList.add("text-slate-500");
        btnPhone.classList.remove("bg-white", "text-slate-800", "shadow-sm");
      } else {
        // Si el método es 'phone'
        inputField.type = "tel";
        inputField.placeholder = "Ingresa tu número de WhatsApp";
        hiddenMethodInput.value = "WhatsApp"; // Actualizamos el valor del campo oculto

        // Actualizamos los estilos de los botones
        btnPhone.classList.add("bg-white", "text-slate-800", "shadow-sm");
        btnPhone.classList.remove("text-slate-500");
        btnEmail.classList.add("text-slate-500");
        btnEmail.classList.remove("bg-white", "text-slate-800", "shadow-sm");
      }
      inputField.value = ""; // Limpiamos el campo al cambiar de método
      inputField.focus(); // Ponemos el foco en el campo para que el usuario escriba
    }

    // Añadimos los eventos de clic a los botones
    btnEmail.addEventListener("click", () => updateFormUI("email"));
    btnPhone.addEventListener("click", () => updateFormUI("phone"));

    // Inicializamos el formulario en el estado de "email"
    updateFormUI("email");
  });
</script>
